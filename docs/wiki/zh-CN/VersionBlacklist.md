# Version Blacklist - 版本黑名单

## 说明

本项目的版本黑名单，列出了本项目的版本黑名单，请注意避免使用这些版本。

列入黑名单的版本，可能是因为以下原因：

- 该版本存在严重的 Bug，可能会导致核心功能无法正常使用。
- 该版本存在严重的 Bug，可能会导致数据丢失、数据错误等严重后果。

## 设计目的

该黑名单旨在帮助开发人员快速识别各版本中已知的问题点，明确受影响的模块与典型触发场景，从而做出基于事实的用/避决策与迁移安排，
而不是简单地“一刀切”禁用某一版本。

## 如何使用

黑名单不是绝对禁用清单。遇到被列入黑名单的版本时，应当基于“问题原因—是否命中—影响面”的原则进行研判：

- 是否直接或间接使用了被提及的模块/类（例如：`com.dwarfeng.subgrade.impl.cache.RedisKeyListCache`）。
- 业务中是否存在与“原因”描述相符的顺序敏感或易触发场景（例如：对列表型缓存的严格顺序一致性要求）。
- 是否已出现与问题相符的日志告警、数据核对失败或线上异常案例。

若未使用黑名单中提及的问题代码部分，或经过验证不命中触发条件，则仍然可以继续使用该版本；若命中或存在较大不确定性，
建议参考对应编号“详细原因”章节末尾的迁移建议执行升级或规避方案，并充分做回归与灰度验证。

请注意：迁移建议仅针对对应编号的问题，所推荐版本可能仍存在其他风险。请继续核查该推荐版本是否仍在黑名单中；
若仍在黑名单中，请持续研判并迭代升级，直至风险可接受或升级至未被列入黑名单的版本。

## 版本黑名单

| 编号                                                 | 大版本   | 起始版本    | 结束版本     | 原因                        |
|----------------------------------------------------|-------|---------|----------|---------------------------|
| [BLACKLIST-20251031.1](#BLACKLIST-202510311)       | 1.7.x | 1.7.0.a | 1.7.0.a  | Redis 缓存在顺序敏感场景可能导致数据顺序错误 |
| [BLACKLIST-20251031.1](#BLACKLIST-202510311)       | 1.6.x | 1.6.0.a | 1.6.0.a  | Redis 缓存在顺序敏感场景可能导致数据顺序错误 |
| [BLACKLIST-20251031.1](#BLACKLIST-202510311)       | 1.5.x | 1.5.0.a | 1.5.11.a | Redis 缓存在顺序敏感场景可能导致数据顺序错误 |
| [BLACKLIST-20251031.1](#BLACKLIST-202510311)       | 1.4.x | 1.4.0.a | 1.4.8.a  | Redis 缓存在顺序敏感场景可能导致数据顺序错误 |
| [BLACKLIST-20251031.1](#BLACKLIST-202510311)       | 1.3.x | 1.3.0.a | 1.3.3.a  | Redis 缓存在顺序敏感场景可能导致数据顺序错误 |
| [BLACKLIST-20251031.1](#BLACKLIST-202510311)       | 1.2.x | 1.2.0.a | 1.2.14.a | Redis 缓存在顺序敏感场景可能导致数据顺序错误 |
| [BLACKLIST-20251031.1](#BLACKLIST-202510311)       | 1.1.x | 1.1.0.a | 1.1.8.a  | Redis 缓存在顺序敏感场景可能导致数据顺序错误 |
| [BLACKLIST-20251031.1](#BLACKLIST-202510311)       | 1.0.x | 1.0.0.a | 1.0.2.a  | Redis 缓存在顺序敏感场景可能导致数据顺序错误 |
| [BLACKLIST-LEGACY-1.5.5.a](#BLACKLIST-LEGACY-155a) | 1.5.x | 1.5.5.a | 1.5.5.a  | 核心类构造器方法存在缺陷              |
| [BLACKLIST-LEGACY-1.5.4.a](#BLACKLIST-LEGACY-154a) | 1.5.x | 1.5.4.a | 1.5.4.a  | 核心类构造器方法存在缺陷              |
| [BLACKLIST-LEGACY-1.4.8.a](#BLACKLIST-LEGACY-148a) | 1.4.x | 1.4.8.a | 1.4.8.a  | 核心类存在严重 bug               |

## 详细原因

### BLACKLIST-20251031.1

原因：Redis 缓存实现存在 bug，在顺序敏感的场景下可能导致数据顺序错误。

- 受影响模块/类：
  - `com.dwarfeng.subgrade.impl.cache.RedisKeyListCache`
- 典型触发条件：
  - 对列表型数据进行写入后立即读取，业务对元素顺序有严格一致性要求；
  - 聚合/分页/幂等校验等依赖稳定顺序的链路；
  - 并发写入或合并写入的场景更易显现。
- 典型症状：
  - 缓存中列表顺序与入参不一致；
  - 上层出现数据错位、比对失败、幂等校验异常。
- 影响范围：
  - 直接或间接依赖上述缓存实现、并对顺序敏感的上层功能与接口。

迁移建议：升级至 1.7.1.a 及以上版本。

### BLACKLIST-LEGACY-1.5.5.a

原因： 部分类中缺失构造器方法。

- 部分类中缺失构造器方法。
  - com.dwarfeng.subgrade.impl.service.DaoOnlyBatchWriteService。

迁移建议：升级至 1.5.6.a 及以上版本。

### BLACKLIST-LEGACY-1.5.4.a

原因： 部分类中缺失构造器方法。

- 部分类中缺失构造器方法。
  - com.dwarfeng.subgrade.impl.service.DaoOnlyBatchWriteService。

迁移建议：升级至 1.5.5.a 及以上版本。

### BLACKLIST-LEGACY-1.4.8.a

原因： 核心类存在严重 bug。

- 部分数据访问层存在严重 bug，导致其数据查询功能出现数据错误。
  - com.dwarfeng.subgrade.impl.dao.HibernatePresetLookupDao。

迁移建议：升级至 1.4.5.b 及以上版本。

## 注意事项

- 黑名单用于风险提示，并非强制禁用。是否升级或规避，应以是否命中“详细原因”所述的模块与场景为依据。
- 建议遵循生产变更流程：评估 -> 测试 -> 灰度 -> 观测 -> 全量，过程中启用充分的日志与指标监控。
- 如发现新问题或修复版本，请同步更新本黑名单与变更记录，保持信息一致性。
